<?xml version="1.0"?>
<!-- 
    Copyright (c) 2009-2010 Flagstone Software Ltd. All rights reserved. 
-->
<project name="transform" default="all" basedir=".">

	<description>ANT build file for Transform.

        The following major targets are available:

        all        used to create a version of Transform that can be used in
	               production code. It compiles a clean, optimised version of
                   the classes and packages them in a JAR.

        The following minor targets provide more control over the compiling
        and packaging of classes.

        clean      removes all the files generated by any of the targets.

        compile    compile the classes in all the packages.
        
        debug      compile debug, unoptimised versions all of the classes. To 
                   build a jar file execute the targets: clean, debug, jar.

        jar        packages all of the compiled classes in the target directory
                   into a JAR file.

        docs       generate the javadocs for the public classes and methods.

    </description>

	<property name="src.dir" location="src" />
	<property name="build.dir" location="target" />
	<property name="package.dir" value="com/flagstone/${project.artifactId}" />
    <property name="version" value="${project.version}" />

	<!-- **********************************************************
         Major targets for compiling and packaging the classes.
     ********************************************************** -->

	<target name="all" depends="clean,compile,jar,docs" 
		description="Build a JAR file containing optimised classes and generate the javadocs" />

	<!-- *******************************************************************
         Minor targets to compile and package different sets of classes.
     ******************************************************************* -->

	<target name="clean" description="Remove all the compiled classes">
		<delete dir="${build.dir}" failonerror="false" />
		<mkdir dir="${build.dir}" />
	</target>

	<target name="compile" description="Compile optimised versions of the classes">

		<mkdir dir="${build.dir}/classes" />

		<javac srcdir="${src.dir}" destdir="${build.dir}/classes" 
			debug="off" optimize="on" source="1.6">
			<include name="${package.dir}/**" />
		</javac>

	</target>

	<target name="debug" description="Compile debug versions of the classes">

		<mkdir dir="${build.dir}/classes" />

		<javac srcdir="${src.dir}" destdir="${build.dir}/classes" 
			debug="on" optimize="off" source="1.6">
			<include name="${package.dir}/**" />
		</javac>

	</target>

	<target name="jar" description="Package all of the classes in a JAR file">

		<jar jarfile="${build.dir}/${project.artifactId}-${version}.jar">
			<fileset dir="${build.dir}/classes">
				<include name="${package.dir}/**" />
			</fileset>
		</jar>

	</target>

	<target name="docs" description="Generate the javadocs">

		<javadoc sourcepath="src" destdir="${build.dir}/docs" public="true"/>

	</target>

</project>
